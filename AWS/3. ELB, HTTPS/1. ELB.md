# 📚 AWS - Elastic Load Balance

> 💡 트래픽부하를 적적할게 분배해주는 장치이다.

## ELB란?
트래픽 부하를 적절하게 분배해주는 장치를 보고 전문적인 용어로 로드밸러서(Load Balancer)라고 부른다. 서버를 2대 이상 가용할 때 ELB를 필수적으로 도입하게 된다. 

* ELB를 사용하기 전의 아키텍처는 사용자들이 EC2의 IP 주소 또는 도메인 주소에 직접 요청을 보내는 구조였다. 
* 하지만 ELB를 추가적으로 도입함으로써 사용자들이 EC2에 직접적으로 요청을 보내지 않고 ELB를 향해 요청을 보내도록 구성을 하여 
* EC2 달았던 도메인도 ELB에 달 것이고, HTTPS도 ELB의 도메인에 적용시켜 ELB에 접속해도 EC2로 접근을 할 수 있게 할 수 있다.

<img width="752" height="574" alt="Image" src="https://github.com/user-attachments/assets/b1117cf8-c938-4c87-a16d-aafbbf201477" />

## ELB(로드 벨러서) 생성 방법

1. EC2 에 로드 밸런서에 들어 가 로드 밸러서 생성을 한다.
2. Application Load Balancaer 생성을 선택한다.
3. 아래 이미지 처럼 이름을 작성합니다.
<img width="1229" height="534" alt="Image" src="https://github.com/user-attachments/assets/ca50ab5b-1d51-4c12-8eca-54d17d852220" />

* 네트워크 매핑은 로드 밸런서가 어떤 가용 영역으로만 트래픽을 보낼 건지 제한하는 기능이다. 
* 가용 영역에 제한을 두지 않고 모든 영역에 트래픽을 보내게하기 위해 다 선택한다. 
<img width="1647" height="886" alt="Image" src="https://github.com/user-attachments/assets/f77e808f-1245-4dd5-88bc-e921d9a7258d" />

1. 보안 그룹에 보안 그럽 설정을 해주어야 한다. (아래에 생성 방법을 정리했다.)

<img width="1199" height="230" alt="Image" src="https://github.com/user-attachments/assets/54a36e5c-25a2-43ee-95a5-9a465c5e2f40" />

* 보안 그룹은 따로 이전에 설정을 해주었어야 하는데
* ELB의 특성상 인바운드 규칙에 80(`HTTP`), 443(`HTTPS`) 포트로 모든 IP에 대해 요청을 받을 수 있게 설정해 주어야 한다.
* ELB에 전달된 요청을 EC2에 전달을해주는데 80이랑 443요청은 허용해 주기 위함이다.
<img width="1638" height="895" alt="Image" src="https://github.com/user-attachments/assets/e7efe529-509c-47af-91f5-f2a25dc6a5c3" />

1. 리스너 생성을 눌러 리스너를 추가해주어야 한다. (아래에 생성 방법을 정리했다.)
<img width="685" height="308" alt="Image" src="https://github.com/user-attachments/assets/84e1831a-a2e4-4ee1-8ca0-ab14d69d7bfd" />

* 대상 유형 선택하기에서 인스턴스를 선택하면 아래 이미지 처럼 나온다.
* 아래 이미지는 ELB가 사용자로부터 트래픽을 받아 대상 그룹에게 어떤 방식으로 전달할 지 설정하는 부분이다. 위 그림은 HTTP(HTTP1), 80번 포트, IPv4 주소로 통신을 한다는 걸 뜻한다.
* 그 후 로드 벨러서를 생성하면 된다.
<img width="680" height="603" alt="Image" src="https://github.com/user-attachments/assets/f067f1b3-0325-44f1-b8a6-f78f7200efd1" />

## ELB 도메인 연결 
1. Route 53에 들어가 호스팅에서 레코드 생성을 해줍니다.
2. 아래 이미지 처럼 별칭을 눌러 별칭과 리전을 선택하고 아까 생성한 로드 밸러서도 선택하고 레코드 생성을 하면된다.
   
<img width="1669" height="681" alt="Image" src="https://github.com/user-attachments/assets/61764e04-5ca2-400e-a82e-f3f82b6ca55a" />

