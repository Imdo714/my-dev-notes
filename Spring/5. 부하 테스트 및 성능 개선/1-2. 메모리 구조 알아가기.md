# 📚 Spring - Java 메모리 영역 구조 알아가기 

> 💡 

## JVM 란?
* JVM(`Java Virtual Machine`)은 자바를 실행하기 위한 가상 기계, 자바와 운영체제 사이에서 중개자 역할을 수행하며 
* 자바가 운영체제에 구애 받지 않고 프로그램을 실행할 수 있도록 도와줍니다. 
* 즉, 자바 코드를 실행하려면 그냥 OS가 실행하는게 아니라 JVM이 해석하고 관리해 줍니다.
* 또한 메모리 힙에 올라온 불필요한 값들을 가바지 컬렉터로 불필요한 메모리 정리까지 JVM이 대신 해줍니다.

## JVM 컴파일 과정
* 우리가 작성한 Java코드는 기계가 이해할 수 없어 읽을 수 있도록 기계어로 컴파일 해주는 과정이 필요 합니다.
* Java는 다른 언어와 달리 기계어로 바로 컴파일 되는게 아니라, JVM이라는 가상머신을 거친 후 OS로 전달하는 구조를 가져
* Java코드를 컴파일시 JVM이 읽을 수 있는 `bytecode`(`.class`)로 변환 후 다시 JVM이 `bytecode`를 `Interpreter`와 `JIT`컴파일러를 이용해 기계어로 변환합니다.

<img width="957" height="418" alt="Image" src="https://github.com/user-attachments/assets/54504a25-2b49-4e33-831b-0ae927cdcfb6" />

* 인터프리터 (`Interpreter`) : 바이트 코드 명령어를 하나씩 읽어서 해석하고 바로 실행 
* `JIT` 컴파일러 : 자주 실행되는 부분을 기계어 코드로 변환 후 캐싱하여 재사용합니다.

## JVM 메모리 구조 
* 자바 애플리케이션을 실행할 때 사용되는 데이터들을 적재 하는 곳을 **"런타입 데이터 영역"** 이라고 합니다.
* 런타입 데이터 영역은 여러 종류가 있지만, 핵심적으로 이해해야 할 부분은 `Method`, `Heap`, `Stack`영역입니다.
* 이때 `Method`, `Heap`은 모든 쓰레드(`Thread`)가 공유하는 영역이며 `Stack`은 각 쓰레드(`Thread`) 마다 생성되는 개별 영역입니다.

## Method(Static) 영역 
* `Method`영역은 클래스를 구성하는 (`클래스 정보`, `static 변수`, `상수`, `메서드 코드`) 정보들이 저장되는 영역입니다. 
* JVM이 동작해서 클래스가 로딩될 때 생성되며 프로그램이 시작될 때부터 종료될 때까지 메모리에 남아있습니다.

## Heap 영역 
* `Heap`영역은 동적으로 할당된 메모리 영역이며, `Method`와 함께 모든 쓰레드가 공유합니다.
* `Heap`영역에는 new 연산자로 생성되는 클래스와 인스턴스 변수, 배열 타입 등 `Reference Type`이 저장됩니다. 
* 힙의 특징으로는 동적으로 메모리가 할당되고 해제됩니다. 이때 더이상 사용되지 않는 객체는 가바지 컬렉터에 의해 자동으로 메모리에서 제거됩니다.

## Stack 영역 
* `Stack`영역에는 함수 관련 데이터 (`지역변수`, `매개변수`, `리턴 값`)등이 저장됩니다.
* 메서드가 정의하는 기본 자료형에 해당되는 지역변수의 데이터 값이 저장됩니다.
* 메서드가 호출될 때 메모리에 할당되고 종료되면 메모리에서 제거됩니다.
* 스택은 마지막에 들어온 값이 먼저 나가는 후입선출(`LIFO`) 구조로 되어있습니다.

## 예제 코드
```java
public class MemoryExample {
    // 메서드(Method) 영역에 저장
    static int staticNum = 100;
    static final String CONST_HELLO = "Hello";

    public static void main(String[] args) {
        // Stack 영역
        int age = 32;

        // name은 Stack에 저장, 참조값 "Lim"은 Heap에 저장
        String name = "Lim";

        System.out.println(name + " is " + age);
    }
}
```

<img width="1267" height="635" alt="Image" src="https://github.com/user-attachments/assets/b52101b3-608c-45a4-80cd-f9c068d4070b" />

## 

