# ğŸ“š ìŠ¤í”„ë§ - ê°’ íƒ€ì…
 
> ğŸ’¡ ì„ë² ë””ë“œ íƒ€ì…ì€ 2ê°œ ì´ìƒì˜ í•„ë“œë¥¼ ë¬¶ì–´ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ í‘œí˜„í•˜ì—¬ ì¬ì‚¬ìš©ì„±, ì‘ì§‘ë ¥ì´ ì¢‹ì•„ ìì£¼ ì‚¬ìš©ëœë‹¤.

## ğŸš€ì—”í‹°í‹° íƒ€ì…ê³¼ ê°’ íƒ€ì… 
> JPAì˜ ë°ì´í„° íƒ€ì…ì„ ê°€ì¥ í¬ê²Œ ë¶„ë¥˜í•˜ë©´ ì—”í‹°í‹° íƒ€ì…ê³¼ ê°’ íƒ€ì…ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.
* ì—”í‹°í‹° íƒ€ì…
  * `@Entity`ë¡œ ì •ì˜í•˜ëŠ” ê°ì²´ì´ë‹¤.
  * ì‹ë³„ìë¥¼ í†µí•´ ì§€ì†í•´ì„œ ì¶”ì í•  ìˆ˜ ìˆë‹¤.
* ê°’ íƒ€ì… 
  * `int`, `Integer`, `String` ì²˜ëŸ¼ ë‹¨ìˆœíˆ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìë°” ê¸°ë³¸ íƒ€ì… ë˜ëŠ” ê°ì²´
  * ì‹ë³„ìê°€ ì—†ë‹¤.
  * ê°’ íƒ€ì…ì„ 3ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆìŒ
    * **ê¸°ë³¸ê°’ íƒ€ì…** : ìë°” ê¸°ë³¸ ë°ì´í„° íƒ€ì…
    * **ì„ë² ë””ë“œ íƒ€ì…** : JPAì—ì„œ ì‚¬ìš©í•˜ì‘ ì§ì ‘ ì •ì˜í•œ ê°’ íƒ€ì…
    * **ì»¬ë ‰ì…˜ ê°’ íƒ€ì…** : í•˜ë‚˜ ì´ìƒì˜ ê°’íƒ€ì… ì €ì¥ì‹œ ì‚¬ìš©

## ğŸ¥¦ì„ë² ë””ë“œ íƒ€ì…(ë³µí•© ê°’ íƒ€ì…)
* JPAì—ì„œ ì„ë² ë””ë“œ íƒ€ì…(`Embedded Type`)ì€ í•˜ë‚˜ì˜ ì—”í‹°í‹° ì•ˆì— í¬í•¨ë˜ëŠ” ê°’ ê°ì²´(`Value Object`)ë¥¼ ë§ í•œë‹¤.
* ê°ì²´ ì§€í–¥ì ìœ¼ë¡œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê°’ íƒ€ì…ì„ ë¶„ë¦¬í•  ë•Œ ì‚¬ìš©ë˜ë©°, í…Œì´ë¸”ì€ ë¶„ë¦¬ë˜ì§€ ì•Šê³  ê°™ì€ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ìœ¼ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤.

### ì„ë² ë””ë“œ íƒ€ì… - 2ê°€ì§€ ì–´ë…¸í…Œì´ì…˜
> ğŸ’¡ì„ë² ë””ë“œ íƒ€ì…ì€ ê¸°ë³¸ ìƒì„±ìê°€ í•„ìˆ˜ë‹¤.
* `@Embeddable`: ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ 
* `@Embedded`: ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ

## ğŸ’¦ì„ë² ë””ë“œ íƒ€ì… ì˜ˆì œ 
* íšŒì› ì—”í‹°í‹°ëŠ” ì´ë¦„, ê·¼ë¬´ ì‹œì‘ì¼, ê·¼ë¬´ ì¢…ë£Œì¼, ì£¼ì†Œ ë„ì‹œ, ì£¼ì†Œ ë²ˆì €, ì£¼ì†Œ ìš°í¸ë²ˆí˜¸ë¥¼ ê°€ì§„ë‹¤. 
* ì´ëŸ° ì„¤ëª…ì€ ë‹¨ìˆœíˆ ì •ë³´ë¥¼ í’€ì–´ë‘” ê²ƒ ë¿ì´ë‹¤. ê·¼ë¬´ ì‹œì‘ì¼ê³¼ ìš°í¸ë²ˆí˜¸ëŠ” ì„œë¡œ ì•„ë¬´ ê´€ë ¨ì´ ì—†ë‹¤. 
* ì´ê²ƒë³´ë‹¨ `íšŒì› ì—”í‹°í‹°ëŠ” ì´ë¦„, ê·¼ë¬´ ê¸°ê°„, ì§‘ ì£¼ì†Œë¥¼ ê°€ì§„ë‹¤.` ë¼ëŠ” ì„¤ëª…ì´ë” ëª…í™•í•˜ë‹¤.
* íšŒì›ì´ ìƒì„¸ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ê°€ì§€ê³  ìˆëŠ” ê²ƒì€ ê°ì²´ì§€í–¥ì ì´ì§€ ì•Šìœ¼ë©° ì‘ì§‘ë ¥ë§Œ ë–¨ì–´ëœ¨ë¦°ë‹¤.

```java
@Embeddable
public class Period {
    private Date startDate;
    private Date endDate;
    public Period() {} // JPA ê¸°ë³¸ ìƒì„±ì
}
```
```java
@Embeddable
public class Address {
    @Column(name = "city") // ë§¤í•‘í•  ì»¬ëŸ¼ ì •ì˜ ê°€ëŠ¥ 
    private String city;
    private String street;
    private String zipcode;
    public Address() {} // JPA ê¸°ë³¸ ìƒì„±ì
}
```
```java
@Entity
public class Member {

  @Id @GeneratedValue
  private Long id;
  private String name;

  @Embedded
  private Period workPeriod; // ê·¼ë¬´ ì‹œê°„
  @Embedded
  private Address homeAddress; // ì§‘ ì£¼ì†Œ
}
```
```oracle
create table member (
      id bigint,
      name varchar(255),
      startDate timestamp,
      endDate timestamp,
      city varchar(255),
      street varchar(255),
      zipcode varchar(255)
)
```
* ìƒˆë¡œ ì •ì˜í•œ ê°’ íƒ€ì…ë“¤ì€ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì‘ì§‘ë„ë„ ì•„ì£¼ ë†’ë‹¤. 
* ì—”í‹°í‹° ë‚´ë¶€ì— í¬í•¨ë˜ëŠ” ê°ì²´ëŠ” ë¶„ë¦¬ ë˜ì–´ë„ ë³„ë„ì˜ í…Œì´ë¸”ì€ ë¶„ë¦¬ ë˜ì§€ ì•ŠëŠ”ë‹¤. 
* ì„ë² ë””ë“œ íƒ€ì… ë•ë¶„ì— ê°ì²´ì™€ í…Œì´ë¸”ì„ ì•„ì£¼ ì„¸ë°€í•˜ê²Œ ë§¤í•‘í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.
* ì˜ ì„¤ê³„í•œ ORM ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë§¤í•‘í•œ í…Œì´ë¸”ì˜ ìˆ˜ë³´ë‹¤ í´ë˜ìŠ¤ì˜ ìˆ˜ê°€ ë” ë§ë‹¤.

ORM ì—†ì´ ê°œë°œí•˜ë©´ í…Œì´ë¸”ê³¼ ê°ì²´ë¥¼ 1:1ë¡œ ë§¤í•‘í•´ì•¼ í•´ì„œ ê°ì²´ì§€í–¥ì ì¸ ì„¤ê³„ê°€ ì–´ë µë‹¤.
íŠ¹íˆ ì£¼ì†Œë‚˜ ê·¼ë¬´ ê¸°ê°„ ê°™ì€ ê°’ íƒ€ì…ì„ í´ë˜ìŠ¤ë¡œ ë¶„ë¦¬í•˜ê³  ì‹¶ì–´ë„ SQLì„ ì§ì ‘ ë‹¤ë£¨ëŠ” ìƒí™©ì—ì„œëŠ” ë²ˆê±°ë¡­ê³  ë³µì¡í•˜ë‹¤.
ì´ëŸ° ë°˜ë³µì ì´ê³  ì§€ë£¨í•œ ì‘ì—…ì€ JPAì— ë§¡ê¸°ê³ , ìš°ë¦¬ëŠ” ë” ì„¸ë°€í•˜ê³  í‘œí˜„ë ¥ ìˆëŠ” ê°ì²´ì§€í–¥ ëª¨ë¸ ì„¤ê³„ì— ì§‘ì¤‘ í•  ìˆ˜ ìˆë‹¤.

![Image](https://github.com/user-attachments/assets/12f1ddff-5f72-4a88-a57d-576c6d6250ba)

## ğŸ“»`@AttributeOverride` : ì†ì„± ì¬ì •ì˜
* ì„ë² ë””ë“œ íƒ€ì…ì— ì €ìœ¼ì´í•œ ë§¤í•‘ì •ë³´ë¥¼ ì¬ì •ì˜í•˜ë ¤ë©´ ì—”í‹°í‹°ì— `@AttributeOverride`ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
* `Member`ì—”í‹°í‹°ì— ì§‘ ì£¼ì†Œì— íšŒì‚¬ ì£¼ì†Œë¥¼ í•˜ë‚˜ ë” ì¶”ê°€í–ˆë‹¤. ë¬¸ì œëŠ” í…Œì´ë¸”ì— ë§¤í•‘í•˜ëŠ” ì»¬ëŸ¼ëª…ì´ ì¤‘ë³µë˜ëŠ” ê²ƒì´ë‹¤.
* ì´ë•Œ `@AttributeOverride`ë¥¼ ì‚¬ìš©í•´ ë§¤í•‘ì •ë³´ë¥¼ ì¬ì •ì˜í•´ì•¼ í•œë‹¤.

```java
@Entity
public class Member {

  @Id @GeneratedValue
  private Long id;
  private String name;
  
  @Embedded
  private Address homeAddress; // ì§‘ ì£¼ì†Œ
  @Embedded
  private Address companyAddress; // íšŒì‚¬ ì£¼ì†Œ
}
```
* `@AttributeOverride`ë¥¼ ì‚¬ìš©í•˜ë©´ ì–´ë…¸í…Œì´ì…˜ì„ ë„ˆë¬´ ë§ì´ ì‚¬ìš©í•´ì„œ ì—”í‹°í‹° ì½”ë“œê°€ ì§€ì €ë¶„í•´ì§„ë‹¤.
* ë‹¤í–‰íˆë„ í•œ ì—”í‹°í‹°ì— ê°™ì€ ì„ë² ë””ë“œ íƒ€ì…ì„ ì¤‘ë³µí•´ì„œ ì‚¬ìš©í•˜ëŠ” ì¼ì€ ë§ì§€ ì•Šë‹¤.
```java
@Entity
public class Member {
    @Embedded Address homeAddress;
    
    @Embedded 
    @AttributeOverrides({
    	@AttributeOverride(name = "city", column=@Column(name="COMPANY_CITY")),
        @AttributeOverride(name = "street", column=@Column(name="COMPANY_STREET")),
        @AttributeOverride(name = "zipcode", column=@Column(name="COMPANY_ZIPCODE"))
    })
    Address companyAddress;
}
```

## ğŸ²ê°’ íƒ€ì… ì»¬ë ‰ì…˜ 
* ê°’ íƒ€ì…ì„ í•˜ë‚˜ ì´ìƒ ì €ì¥í•˜ë ¤ë©´ ì»¬ë ‰ì…˜ì— ë³´ê´€í•˜ê³  `@ElementCollection`, `@CollectionTable` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
* Member ì—”í‹°í‹°ë¥¼ ë³´ë©´ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•˜ëŠ” `favoriteFoods`, `addressHistory`ì— `@ElementCollection`ì„ ì§€ì •í–ˆë‹¤.
* `favoriteFoods`ëŠ” ê¸°ë³¸ê°’ íƒ€ì…ì¸ `String`ì„ ì»¬ë ‰ì…˜ìœ¼ë¡œ ê°€ì§„ë‹¤. ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” í…Œì´ë¸”ì€ ì»¬ëŸ¼ ì•ˆì— ì»¬ë ‰ì…˜ì„ í¬í•¨í•  ìˆ˜ ì—†ë‹¤. 
* ë”°ë¼ì„œ ë³„ë„ì˜ í…Œì´ë¸”ì„ ì¶”ê°€í•˜ê³  `@CollectionTable`ì„ ì‚¬ìš©í•´ ì¶”ê°€í•œ í…Œì´ë¸”ì„ ë§¤í•‘ í•´ì•¼ í•œë‹¤.
* ê·¸ë¦¬ê³  `favoriteFoods`ì²˜ëŸ¼ ê°’ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ì´ í•˜ë‚˜ë©´ `@Column`ì„ ì‚¬ìš©í•´ì„œ ì»¬ëŸ¼ëª…ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
* `addressHistory`ëŠ” ì„ë² ë¹„ë“œ íƒ€ì…ì¸ `Address`ë¥¼ ì»¬ë ‰ì…˜ìœ¼ë¡œ ê°€ì§„ë‹¤. ì´ê²ƒë„ ë³„ë„ì˜ í…Œì´ë¸”ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
```java
@Entity
public class Member {
	
    @Id @GeneratedValue
    private Long id;
    
    @Embedded
    private Address address;
    
    @ElementCollection
    @CollectionTable(name = "FAVORITE_FOODS",
    	joinColumns = @JoinColumn(name = "MEMBER_ID"))
    @Column(name = "FOOD_NAME")
    private Set<String> favoriteFoods = new HashSet<>();
    
    @ElementCollection
    @CollectionTable(name = "ADDRESS",
    	joinColumns = @JoinColumn(name = "MEMBER_ID"))
    private List<Address> addressHistory = new ArrayList<>();
}
```
```java
@Embeddable
public class Address {
	
    @Column
    private String city;
    private String street;
    private String zipcode;
}
```
* ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì€ ì˜ì†ì„± ì „ì´(`cascade`) + ê³ ì•„ ê°ì²´ ì œê±°(`orphan remove`) ê¸°ëŠ¥ì„ í•„ìˆ˜ë¡œ ê°€ì§„ë‹¤. 
* ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì€ ì¡°íšŒí•  ë•Œ í˜ì¹˜ ì „ëµì„ ì„ íƒí•  ìˆ˜ ìˆëŠ”ë° `FetchType.LAZY`ê°€ ê¸°ë³¸ì´ë‹¤.

![Image](https://github.com/user-attachments/assets/af57c898-d739-44c9-a343-bf63bdf808cf)


